#!/bin/sh -ex
rm -f xbuild
rm -fR bin build
if [ "${XBUILD}" ]; then
  # write gradle.properties
  echo "version=${XBUILD?}" > gradle.properties
  # write banner.txt
  cowsay "${XBUILD?}" > src/main/resources/banner.txt
  # write proprietary xbuild.properties
  buildpropertiesfile="src/main/resources/xbuild.properties"
  echo "xbuild=${XBUILD?}" > ${buildpropertiesfile?}
  echo "xbuild.branch=${XBUILD_BRANCH?}" >> ${buildpropertiesfile?}
  echo "xbuild.number=${XBUILD_NUMBER?}" >> ${buildpropertiesfile?}
  echo "xbuild.commit=${XBUILD_COMMIT?}" >> ${buildpropertiesfile?}
  echo "xbuild.committime=${XBUILD_COMMITTIME?}" >> ${buildpropertiesfile?}
fi
gradle bootJar
